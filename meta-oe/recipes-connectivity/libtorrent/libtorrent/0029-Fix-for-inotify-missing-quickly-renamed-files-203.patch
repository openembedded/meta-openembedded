From 7c80dc3e3a47dd996ca0554fce4f69d16761a9c9 Mon Sep 17 00:00:00 2001
From: Tadej Obrstar <tadej.obrstar@gmail.com>
Date: Sun, 1 Dec 2019 06:59:25 +0100
Subject: [PATCH] Fix for inotify missing quickly renamed files (#203)

---
 src/torrent/utils/directory_events.cc | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/torrent/utils/directory_events.cc b/src/torrent/utils/directory_events.cc
index 5d789f4e..8dcc2a61 100644
--- a/src/torrent/utils/directory_events.cc
+++ b/src/torrent/utils/directory_events.cc
@@ -154,8 +154,11 @@ directory_events::event_read() {
     wd_list::const_iterator itr = std::find_if(m_wd_list.begin(), m_wd_list.end(),
                                                std::bind(&watch_descriptor::compare_desc, std::placeholders::_1, event->wd));
 
-    if (itr != m_wd_list.end())
-      itr->slot(itr->path + event->name);
+    if (itr != m_wd_list.end()) {
+      std::string sname(event->name);
+      if((sname.substr(sname.find_last_of(".") ) == ".torrent"))
+        itr->slot(itr->path + event->name);
+    }
 
     event = (struct inotify_event*)(next_event);
   }
