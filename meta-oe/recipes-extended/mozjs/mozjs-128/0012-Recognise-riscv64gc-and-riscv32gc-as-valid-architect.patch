From 93d586d712bf34c243c6174425c78d3ab274c6a0 Mon Sep 17 00:00:00 2001
From: Khem Raj <raj.khem@gmail.com>
Date: Tue, 7 Jan 2025 15:17:16 -0800
Subject: [PATCH] Recognise riscv64gc and riscv32gc as valid architectures

Rust uses above for architecture in tuples

Upstream-Status: Pending
Signed-off-by: Khem Raj <raj.khem@gmail.com>
---
 build/autoconf/config.sub                                     | 2 +-
 .../mozbuild/test/configure/test_toolchain_configure.py       | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/build/autoconf/config.sub b/build/autoconf/config.sub
index 2c6a07ab3c..f7ee82380c 100755
--- a/build/autoconf/config.sub
+++ b/build/autoconf/config.sub
@@ -1236,7 +1236,7 @@ case $cpu-$vendor in
 			| powerpc | powerpc64 | powerpc64le | powerpcle | powerpcspe \
 			| pru \
 			| pyramid \
-			| riscv | riscv32 | riscv32be | riscv64 | riscv64be \
+			| riscv | riscv32 | riscv32be | riscv32gc | riscv64 | riscv64be | riscv64gc \
 			| rl78 | romp | rs6000 | rx \
 			| s390 | s390x \
 			| score \
diff --git a/python/mozbuild/mozbuild/test/configure/test_toolchain_configure.py b/python/mozbuild/mozbuild/test/configure/test_toolchain_configure.py
index 1be0d02e54..a476d787b2 100644
--- a/python/mozbuild/mozbuild/test/configure/test_toolchain_configure.py
+++ b/python/mozbuild/mozbuild/test/configure/test_toolchain_configure.py
@@ -1327,6 +1327,10 @@ class LinuxCrossCompileToolchainTest(BaseToolchainTest):
         "mips-unknown-linux-gnu": big_endian + {"__mips__": 1},
         "riscv32-unknown-linux-gnu": little_endian + {"__riscv": 1, "__riscv_xlen": 32},
         "riscv64-unknown-linux-gnu": little_endian + {"__riscv": 1, "__riscv_xlen": 64},
+        "riscv32gc-unknown-linux-gnu": little_endian
+        + {"__riscv": 1, "__riscv_xlen": 32},
+        "riscv64gc-unknown-linux-gnu": little_endian
+        + {"__riscv": 1, "__riscv_xlen": 64},
         "sh4-unknown-linux-gnu": little_endian + {"__sh__": 1},
     }
 
