From 847968ff66f0d743ed2cf3d5f1f7d8d8dafcf42d Mon Sep 17 00:00:00 2001
From: David Bryant <david@wavpack.com>
Date: Wed, 21 Dec 2016 22:18:36 -0800
Subject: [PATCH] CVE-2016-10169

CVE: CVE-2016-10169
Upstream-Status: Backport [https://github.com/dbry/WavPack/commit/4bc05fc490b66ef2d45b1de26abf1455b486b0dc]
Signed-off-by: Gyorgy Sarvari <skandigraun@gmail.com>
---
 src/words.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/words.c b/src/words.c
index c87b8d2..272760a 100644
--- a/src/words.c
+++ b/src/words.c
@@ -1117,6 +1117,10 @@ int32_t FASTCALL get_word (WavpackStream *wps, int chan, int32_t *correction)
 
     low &= 0x7fffffff;
     high &= 0x7fffffff;
+
+    if (low > high)         // make sure high and low make sense
+        high = low;
+
     mid = (high + low + 1) >> 1;
 
     if (!c->error_limit)
