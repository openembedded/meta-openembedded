From d20518168aff435a4843eebb108e5b9df24c19fb Mon Sep 17 00:00:00 2001
From: Sergei Golubchik <serg@mariadb.org>
Date: Mon, 17 Jun 2024 15:54:30 +0200
Subject: [PATCH] also protect the /*!999999 sandbox comment

CVE: CVE-2024-21096
Upstream-Status: Backport [https://github.com/MariaDB/server/commit/d20518168aff435a4843eebb108e5b9df24c19fb]

Signed-off-by: Yogita Urade <yogita.urade@windriver.com>
---
 client/mysqldump.c                            |   2 +-
 mysql-test/main/ddl_i18n_koi8r.result         |  10 +-
 mysql-test/main/ddl_i18n_utf8.result          |  12 +-
 mysql-test/main/lock_view.result              |   4 +-
 mysql-test/main/mysql.result                  |   4 +-
 mysql-test/main/mysqldump-compat-102.result   |   2 +-
 mysql-test/main/mysqldump-max.result          |   4 +-
 mysql-test/main/mysqldump-nl.result           |   4 +-
 mysql-test/main/mysqldump-no-binlog.result    |   2 +-
 mysql-test/main/mysqldump-system.result       |   6 +-
 mysql-test/main/mysqldump-timing.result       |   4 +-
 mysql-test/main/mysqldump-utf8mb4.result      |   2 +-
 mysql-test/main/mysqldump.result              | 201 +++++++++---------
 mysql-test/main/openssl_1.result              |   6 +-
 mysql-test/main/plugin_auth.result            |   2 +-
 mysql-test/main/rpl_mysqldump_slave.result    |  18 +-
 mysql-test/main/trigger_wl3253.result         |   4 +-
 .../suite/archive/archive_bitfield.result     |   2 +-
 .../oracle/r/sp-package-mysqldump.result      |   2 +-
 mysql-test/suite/federated/federatedx.result  |   2 +-
 mysql-test/suite/roles/definer.result         |   2 +-
 mysql-test/suite/s3/mysqldump.result          |   4 +-
 .../suite/sql_sequence/mysqldump.result       |  10 +-
 .../connect/mysql-test/connect/r/mysql.result |   2 +-
 24 files changed, 157 insertions(+), 154 deletions(-)

diff --git a/client/mysqldump.c b/client/mysqldump.c
index 9502227a..767413b1 100644
--- a/client/mysqldump.c
+++ b/client/mysqldump.c
@@ -764,7 +764,7 @@ static void write_header(FILE *sql_file, const char *db_name)
   }
   else
   {
-    fprintf(sql_file, "/*!999999\\- enable the sandbox mode */ \n");
+    fprintf(sql_file, "/*M!999999\\- enable the sandbox mode */ \n");
      if (!opt_compact)
      {
        print_comment(sql_file, 0,
diff --git a/mysql-test/main/ddl_i18n_koi8r.result b/mysql-test/main/ddl_i18n_koi8r.result
index 39bc4d4a..3b31fba7 100644
--- a/mysql-test/main/ddl_i18n_koi8r.result
+++ b/mysql-test/main/ddl_i18n_koi8r.result
@@ -719,7 +719,7 @@ ca	cb
 utf8mb3_general_ci	utf8mb3_general_ci
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -796,7 +796,7 @@ ALTER DATABASE `mysqltest1` CHARACTER SET cp866 COLLATE cp866_general_ci ;
 ---> Dumping mysqltest1 to ddl_i18n_koi8r.sp.mysqltest1.sql
 
 ---> Dump of mysqltest2
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest2` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -1725,7 +1725,7 @@ koi8r_general_ci	utf8mb3_general_ci	koi8r_general_ci	koi8r_general_ci	utf8mb3_ge
 DELETE FROM mysqltest2.log|
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -1808,7 +1808,7 @@ ALTER DATABASE `mysqltest1` CHARACTER SET cp866 COLLATE cp866_general_ci ;
 ---> Dumping mysqltest1 to ddl_i18n_koi8r.triggers.mysqltest1.sql
 
 ---> Dump of mysqltest2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest2` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -2495,7 +2495,7 @@ COLLATION( '
 END	ONE TIME	1970-01-02 00:00:00	NULL	NULL		NULL	NULL	DISABLED	PRESERVE	CREATED	LAST_ALTERED	NULL		1	koi8r	koi8r_general_ci	utf8mb3_unicode_ci
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
diff --git a/mysql-test/main/ddl_i18n_utf8.result b/mysql-test/main/ddl_i18n_utf8.result
index 33ec6e6e..c2bc4980 100644
--- a/mysql-test/main/ddl_i18n_utf8.result
+++ b/mysql-test/main/ddl_i18n_utf8.result
@@ -719,7 +719,7 @@ ca	cb
 utf8mb3_general_ci	utf8mb3_general_ci
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -796,7 +796,7 @@ ALTER DATABASE `mysqltest1` CHARACTER SET cp866 COLLATE cp866_general_ci ;
 ---> Dumping mysqltest1 to ddl_i18n_utf8sp.mysqltest1.sql
 
 ---> Dump of mysqltest2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest2` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -1725,7 +1725,7 @@ utf8mb3_general_ci	utf8mb3_general_ci	koi8r_general_ci	utf8mb3_general_ci	utf8mb
 DELETE FROM mysqltest2.log|
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -1808,7 +1808,7 @@ ALTER DATABASE `mysqltest1` CHARACTER SET cp866 COLLATE cp866_general_ci ;
 ---> Dumping mysqltest1 to ddl_i18n_utf8triggers.mysqltest1.sql
 
 ---> Dump of mysqltest2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest2` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -2495,7 +2495,7 @@ COLLATION(    '—Ç–µ–∫—Å—Ç') AS c4,
 END	ONE TIME	1970-01-02 00:00:00	NULL	NULL		NULL	NULL	DISABLED	PRESERVE	CREATED	LAST_ALTERED	NULL		1	utf8mb3	utf8mb3_general_ci	utf8mb3_unicode_ci
 
 ---> Dump of mysqltest1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
@@ -2563,7 +2563,7 @@ DELIMITER ;
 ---> Dumping mysqltest1 to ddl_i18n_utf8events.mysqltest1.sql
 
 ---> Dump of mysqltest2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest2` /*!40100 DEFAULT CHARACTER SET cp866 COLLATE cp866_general_ci */;
 
diff --git a/mysql-test/main/lock_view.result b/mysql-test/main/lock_view.result
index 04462ce7..8182205e 100644
--- a/mysql-test/main/lock_view.result
+++ b/mysql-test/main/lock_view.result
@@ -16,7 +16,7 @@ create definer=definer@localhost view mysqltest3.v3is as select schema_name from
 create definer=definer@localhost view mysqltest3.v3ps as select user from performance_schema.users where current_connections>0 order by user;
 create definer=definer@localhost view mysqltest3.v3nt as select 1;
 create definer=definer@localhost sql security invoker view mysqltest3.v3i as select * from mysqltest1.t1;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqltest1` /*!40100 DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci */;
 
@@ -236,7 +236,7 @@ create view v1 as select * from (select * from t1) dt;
 lock table v1 read;
 disconnect con1;
 connection default;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 SET @saved_cs_client     = @@character_set_client;
 SET character_set_client = utf8;
 /*!50001 CREATE VIEW `v1` AS SELECT
diff --git a/mysql-test/main/mysql.result b/mysql-test/main/mysql.result
index b983f009..cf0805ef 100644
--- a/mysql-test/main/mysql.result
+++ b/mysql-test/main/mysql.result
@@ -552,7 +552,7 @@ Table	Create Table
 a1\`b1	CREATE TABLE `a1\``b1` (
   `a` int(11) DEFAULT NULL
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_swedish_ci
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `a1\``b1` (
@@ -584,7 +584,7 @@ Table	Create Table
 a1\"b1	CREATE TABLE "a1\""b1" (
   "a" int(11) DEFAULT NULL
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_swedish_ci
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE "a1\""b1" (
diff --git a/mysql-test/main/mysqldump-compat-102.result b/mysql-test/main/mysqldump-compat-102.result
index 35a06d20..656f506f 100644
--- a/mysql-test/main/mysqldump-compat-102.result
+++ b/mysql-test/main/mysqldump-compat-102.result
@@ -58,7 +58,7 @@ BEGIN
 log(0, 'Session ' || connection_id() || ' ' || current_user || ' started');
 END;
 $$
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- MariaDB dump DUMPVERSION  Distrib DISTVERSION, for OS
 --
 -- Host: localhost    Database: db1_mdev17429
diff --git a/mysql-test/main/mysqldump-max.result b/mysql-test/main/mysqldump-max.result
index 86e8eb07..a006b805 100644
--- a/mysql-test/main/mysqldump-max.result
+++ b/mysql-test/main/mysqldump-max.result
@@ -77,7 +77,7 @@ id	name
 3	first value
 4	first value
 5	first value
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -205,7 +205,7 @@ INSERT  IGNORE INTO `t6` VALUES
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/main/mysqldump-nl.result b/mysql-test/main/mysqldump-nl.result
index 1cbc23f9..20a68f6a 100644
--- a/mysql-test/main/mysqldump-nl.result
+++ b/mysql-test/main/mysqldump-nl.result
@@ -12,7 +12,7 @@ create procedure sp() select * from `v1
 1v`;
 flush tables;
 use test;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 --
 -- Current Database: `mysqltest1
@@ -135,7 +135,7 @@ test\`
 \! ls
 #
 test`
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 --
 -- Current Database: `test```
diff --git a/mysql-test/main/mysqldump-no-binlog.result b/mysql-test/main/mysqldump-no-binlog.result
index b9dfb223..4ca25f7c 100644
--- a/mysql-test/main/mysqldump-no-binlog.result
+++ b/mysql-test/main/mysqldump-no-binlog.result
@@ -1,2 +1,2 @@
 mariadb-dump: Error: Binlogging on server not active
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
diff --git a/mysql-test/main/mysqldump-system.result b/mysql-test/main/mysqldump-system.result
index 0b6fe995..5619ec70 100644
--- a/mysql-test/main/mysqldump-system.result
+++ b/mysql-test/main/mysqldump-system.result
@@ -39,7 +39,7 @@ CREATE FUNCTION metaphon RETURNS STRING SONAME "UDF_EXAMPLE_LIB";
 #
 # mysqldump of system tables with --system=all
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -631,7 +631,7 @@ UNLOCK TABLES;
 #
 # mysqldump of system tables with --system=all --replace
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1246,7 +1246,7 @@ UNLOCK TABLES;
 #
 # mysqldump of system tables with --system=all --insert-ignore
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/main/mysqldump-timing.result b/mysql-test/main/mysqldump-timing.result
index 8ae621e5..3f1840a7 100644
--- a/mysql-test/main/mysqldump-timing.result
+++ b/mysql-test/main/mysqldump-timing.result
@@ -7,7 +7,7 @@ CREATE TABLE t1 (i INT);
 INSERT INTO t1 VALUES (0);
 LOCK TABLE t1 WRITE;
 timeout without t1 contents expected
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -31,7 +31,7 @@ SET @save_max_statement_time=@@max_statement_time;
 SET GLOBAL max_statement_time=0.1;
 UNLOCK TABLES;;
 This would be a race condition otherwise, but default max_statement_time=0 makes it succeed
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/main/mysqldump-utf8mb4.result b/mysql-test/main/mysqldump-utf8mb4.result
index e38c8a47..5d07eb06 100644
--- a/mysql-test/main/mysqldump-utf8mb4.result
+++ b/mysql-test/main/mysqldump-utf8mb4.result
@@ -32,7 +32,7 @@ Testing XML format output
 ----
 Testing text format output
 ----
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/main/mysqldump.result b/mysql-test/main/mysqldump.result
index 2f888ddd..ca9260f1 100644
--- a/mysql-test/main/mysqldump.result
+++ b/mysql-test/main/mysqldump.result
@@ -31,7 +31,7 @@ DROP TABLE t1;
 CREATE TABLE t1 (a decimal(64, 20));
 INSERT INTO t1 VALUES ("1234567890123456789012345678901234567890"),
 ("0987654321098765432109876543210987654321");
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -49,7 +49,7 @@ CREATE TABLE t1 (a double);
 INSERT IGNORE INTO t1 VALUES ('-9e999999');
 Warnings:
 Warning	1264	Out of range value for column 'a' at row 1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -72,7 +72,7 @@ INSERT INTO t1 VALUES ('1.2345', 2.3456);
 INSERT INTO t1 VALUES ("1.2345", 2.3456);
 ERROR 42S22: Unknown column '1.2345' in 'field list'
 SET SQL_MODE=@OLD_SQL_MODE;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -86,7 +86,7 @@ INSERT INTO `t1` VALUES
 (1.23450,2.3456),
 (1.23450,2.3456),
 (1.23450,2.3456);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -100,7 +100,7 @@ INSERT INTO `t1` VALUES
 (1.23450,2.3456),
 (1.23450,2.3456),
 (1.23450,2.3456);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -141,7 +141,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -223,7 +223,7 @@ DROP TABLE t1;
 #
 CREATE TABLE t1 (a  VARCHAR(255)) DEFAULT CHARSET koi8r;
 INSERT INTO t1  VALUES (_koi8r x'C1C2C3C4C5'), (NULL);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -265,7 +265,7 @@ DROP TABLE t1;
 #
 CREATE TABLE t1 (a int) ENGINE=MYISAM;
 INSERT INTO t1 VALUES (1), (2);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -291,7 +291,7 @@ UNLOCK TABLES;
 /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -322,7 +322,7 @@ DROP TABLE t1;
 # Bug#2592 mysqldump doesn't quote "tricky" names correctly
 #
 create table ```a` (i int);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE ```a` (
@@ -334,7 +334,7 @@ drop table ```a`;
 # Bug#2591 mysqldump quotes names inconsistently
 #
 create table t1(a int);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -368,7 +368,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -395,7 +395,7 @@ UNLOCK TABLES;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
 set global sql_mode='ANSI_QUOTES';
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -429,7 +429,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -462,7 +462,7 @@ drop table t1;
 #
 create table t1(a int);
 insert into t1 values (1),(2),(3);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -495,7 +495,7 @@ drop table t1;
 #
 # Bug#6101 create database problem
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -522,7 +522,7 @@ USE `test`;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
 create database mysqldump_test_db character set latin2 collate latin2_bin;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -557,7 +557,7 @@ drop database mysqldump_test_db;
 # if it is explicitly set.
 CREATE TABLE t1 (a  CHAR(10));
 INSERT INTO t1  VALUES (_latin1 'ƒ÷‹ﬂ');
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -600,7 +600,7 @@ UNLOCK TABLES;
 # If the future we can move this command into a separate test with
 # checking that "mysqldump" is compiled with "latin1"
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -625,7 +625,7 @@ UNLOCK TABLES;
 /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -650,7 +650,7 @@ UNLOCK TABLES;
 /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -683,7 +683,7 @@ CREATE TABLE t1 (a int);
 CREATE TABLE t2 (a int);
 INSERT INTO t1 VALUES (1),(2),(3);
 INSERT INTO t2 VALUES (4),(5),(6);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -728,7 +728,7 @@ DROP TABLE t2;
 #
 CREATE TABLE t1 (`b` blob);
 INSERT INTO `t1` VALUES (0x602010000280100005E71A);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -770,7 +770,7 @@ DROP TABLE t1;
 CREATE TABLE t1 (a INT) ENGINE=MyISAM;
 INSERT INTO t1 VALUES (1),(2),(3);
 INSERT INTO t1 VALUES (4),(5),(6);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -811,7 +811,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1187,7 +1187,7 @@ F_cd00692c3bfe59267d5ecfac5310286c int,
 F_6faa8040da20ef399b63a72d0e4ab575 int,
 F_fe73f687e5bc5280214e0486b273a5f9 int);
 insert into t1 (F_8d3bba7425e7c98c50f52ca1b52d3735) values (1);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1557,7 +1557,7 @@ drop table t1;
 #
 CREATE TABLE t1 (a int);
 INSERT INTO t1 VALUES (1),(2),(3);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1611,7 +1611,7 @@ CREATE TABLE t1 ( a INT );
 CREATE TABLE t2 ( a INT );
 INSERT INTO t1 VALUES (1), (2);
 INSERT INTO t2 VALUES (1), (2);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1647,7 +1647,7 @@ CREATE TABLE `t2` (
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1720,35 +1720,35 @@ create table t3(a varchar(30) primary key, b int not null);
 test_sequence
 ------ Testing with illegal table names ------
 mariadb-dump: Couldn't find table: "\d-2-1.sql"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "\t1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "\t1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "\\t1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "t\1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "t\1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "t/1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "T_1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "T%1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "T'1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "T_1"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't find table: "T_"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 test_sequence
 ------ Testing with illegal database names ------
 mariadb-dump: Got error: 1049: "Unknown database 'mysqldump_test_d'" when selecting the database
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Got error: 1049: "Unknown database 'mysqld\ump_test_db'" when selecting the database
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 drop table t1, t2, t3;
 drop database mysqldump_test_db;
 use test;
@@ -1810,7 +1810,7 @@ insert into t2 (a, b) values (NULL, NULL),(10, NULL),(NULL, "twenty"),(30, "thir
 	</table_data>
 </database>
 </mysqldump>
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1849,7 +1849,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -1975,7 +1975,7 @@ create table t1(a int);
 create table t2(a int);
 create table t3(a int);
 mariadb-dump: Couldn't find table: "non_existing"
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2025,7 +2025,7 @@ drop table t1, t2, t3;
 create table t1 (a int);
 mariadb-dump: Couldn't execute 'SELECT /*!40001 SQL_NO_CACHE */ `a` FROM `t1` WHERE xx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx': You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' at line 1 (1064)
 mariadb-dump: Got error: 1064: "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' at line 1" when retrieving data from server
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2067,7 +2067,7 @@ CREATE TABLE `t1` (
 PRIMARY KEY (`a b`, `c"d`, `e``f`)
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1;
 insert into t1 values (0815, 4711, 2006);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -2098,7 +2098,7 @@ UNLOCK TABLES;
 /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2154,7 +2154,7 @@ INSERT INTO t2 VALUES ('bingo');
 INSERT INTO t2 VALUES ('waffle');
 INSERT INTO t2 VALUES ('lemon');
 create view v2 as select * from t2 where a like 'a%' with check option;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2254,7 +2254,7 @@ drop database db1;
 use test;
 create table t1(a int);
 create view v1 as select * from t1;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2325,7 +2325,7 @@ INSERT INTO t2 VALUES ('bingo');
 INSERT INTO t2 VALUES ('waffle');
 INSERT INTO t2 VALUES ('lemon');
 create view v2 as select * from t2 where a like 'a%' with check option;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2396,7 +2396,7 @@ use test;
 #
 CREATE TABLE t1 (a char(10));
 INSERT INTO t1 VALUES ('\'');
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2444,7 +2444,7 @@ create  view v1 as
 select * from v3 where b in (1, 2, 3, 4, 5, 6, 7);
 create  view v2 as
 select v3.a from v3, v1 where v1.a=v3.a and v3.b=3 limit 1;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2597,7 +2597,7 @@ end if;
 end	AFTER	0000-00-00 00:00:00	STRICT_TRANS_TABLES,STRICT_ALL_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,TRADITIONAL,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION	root@localhost	latin1	latin1_swedish_ci	latin1_swedish_ci
 INSERT INTO t1 (a) VALUES (1),(2),(3),(22);
 update t1 set a = 4 where a=3;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2731,7 +2731,7 @@ DELIMITER ;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -2883,7 +2883,7 @@ Warning	1287	'<select expression> INTO <destination>;' is deprecated and will be
 set sql_mode='ansi';
 create procedure `a'b` () select 1;
 set sql_mode='';
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3040,7 +3040,7 @@ d
 2003-10-26 02:00:00
 2003-10-26 02:00:00
 set global time_zone='Europe/Moscow';
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3082,7 +3082,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3145,7 +3145,7 @@ a2
 1
 2
 3
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -3226,7 +3226,7 @@ a	b	c
 1	first value	xxxx
 2	second value	tttt
 3	third value	vvv vvv
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3355,7 +3355,7 @@ BEGIN
 SET new.a = 0;
 END|
 SET SQL_MODE = @old_sql_mode;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3419,7 +3419,7 @@ DROP TABLE t1;
 #
 create table t1 (a binary(1), b blob);
 insert into t1 values ('','');
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3455,7 +3455,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3556,7 +3556,7 @@ insert into t values(5, 51);
 create view v1 as select qty, price, qty*price as value from t;
 create view v2 as select qty from v1;
 mysqldump {
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!50001 DROP VIEW IF EXISTS `v1`*/;
 /*!50001 SET @saved_cs_client          = @@character_set_client */;
 /*!50001 SET @saved_cs_results         = @@character_set_results */;
@@ -3572,7 +3572,7 @@ mysqldump {
 /*!50001 SET collation_connection      = @saved_col_connection */;
 
 } mysqldump {
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!50001 DROP VIEW IF EXISTS `v2`*/;
 /*!50001 SET @saved_cs_client          = @@character_set_client */;
 /*!50001 SET @saved_cs_results         = @@character_set_results */;
@@ -3618,7 +3618,7 @@ drop table t1;
 mysqldump {
 mariadb-dump: Got error: 1356: "View 'test.v1' references invalid table(s) or column(s) or function(s) or definer/invoker of view lack rights to use them" when using LOCK TABLES
 mariadb-dump: Couldn't execute 'SHOW FIELDS FROM `v1`': View 'test.v1' references invalid table(s) or column(s) or function(s) or definer/invoker of view lack rights to use them (1356)
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 -- failed on view `v1`: CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v1` AS select `test`.`t1`.`id` AS `id` from `t1`
 
@@ -3635,7 +3635,7 @@ insert into t1 values (1232131);
 insert into t1 values (4711);
 insert into t1 values (3231);
 insert into t1 values (0815);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -3714,7 +3714,7 @@ create table basetable ( id serial, tag varchar(64) );
 create database mysqldump_views;
 use mysqldump_views;
 create view nasishnasifu as select mysqldump_tables.basetable.id from mysqldump_tables.basetable;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `mysqldump_tables` /*!40100 DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci */;
 
@@ -3799,14 +3799,14 @@ create user mysqltest_1@localhost;
 create table t1(a int, b varchar(34));
 reset master;
 mariadb-dump: Couldn't execute 'FLUSH /*!40101 LOCAL */ TABLES': Access denied; you need (at least one of) the RELOAD privilege(s) for this operation (1227)
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't execute 'FLUSH /*!40101 LOCAL */ TABLES': Access denied; you need (at least one of) the RELOAD privilege(s) for this operation (1227)
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 grant RELOAD on *.* to mysqltest_1@localhost;
 mariadb-dump: Couldn't execute 'SHOW MASTER STATUS': Access denied; you need (at least one of) the SUPER, BINLOG MONITOR privilege(s) for this operation (1227)
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 mariadb-dump: Couldn't execute 'SHOW MASTER STATUS': Access denied; you need (at least one of) the SUPER, BINLOG MONITOR privilege(s) for this operation (1227)
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 grant REPLICATION CLIENT on *.* to mysqltest_1@localhost;
 drop table t1;
 drop user mysqltest_1@localhost;
@@ -3865,7 +3865,7 @@ use test;
 #
 # Bug #33762: mysqldump can not dump INFORMATION_SCHEMA
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 DROP TABLE IF EXISTS `TABLES`;
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
@@ -3930,7 +3930,7 @@ DROP TABLE t1;
 CREATE TABLE t2 (a INT) ENGINE=MyISAM;
 CREATE TABLE t3 (a INT) ENGINE=MyISAM;
 CREATE TABLE t1 (a INT) ENGINE=merge UNION=(t2, t3);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -4021,12 +4021,12 @@ connect  user27293,localhost,user1,,mysqldump_test_db,$MASTER_MYPORT,$MASTER_MYS
 connection user27293;
 create procedure mysqldump_test_db.sp1() select 'hello';
 mariadb-dump: user2 has insufficient privileges to SHOW CREATE PROCEDURE `sp1`!
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 -- insufficient privileges to SHOW CREATE PROCEDURE `sp1`
 -- does user2 have permissions on mysql.proc?
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
 /*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
 /*!50003 SET @saved_cs_client      = @@character_set_client */ ;
@@ -4054,7 +4054,7 @@ drop database mysqldump_test_db;
 #
 CREATE TABLE t1 (c1 INT, c2 LONGBLOB);
 INSERT INTO t1 SET c1=11, c2=REPEAT('q',509);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -4102,18 +4102,21 @@ DROP TABLE t1,t2;
 #           "Dump completed on"
 #
 # --skip-dump-date:
+/*M!999999\- enable the sandbox mode */
 --
 
 
 
 -- Dump completed
 # --dump-date:
+/*M!999999\- enable the sandbox mode */
 --
 
 
 
 -- Dump completed on DATE
 # --dump-date (default):
+/*M!999999\- enable the sandbox mode */
 --
 
 
@@ -4128,7 +4131,7 @@ use db42635;
 create table t1 (id int);
 create view db42635.v1 (c) as select * from db42635.t1;
 create view db42635.v2 (c) as select * from db42635.t1;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -4189,7 +4192,7 @@ drop database db42635;
 #
 SET NAMES utf8;
 CREATE TABLE `stra√üe` ( f1 INT );
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -4212,7 +4215,7 @@ UNLOCK TABLES;
 /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -4237,7 +4240,7 @@ UNLOCK TABLES;
 
 DROP TABLE `stra√üe`;
 CREATE TABLE `◊õ◊ì◊©◊í◊õ◊ó◊ö◊ú◊ì◊í◊õ◊ó◊©◊ö◊ì◊í◊ó◊õ◊ö◊ú◊ì◊í◊õ` ( f1 INT );
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -4261,7 +4264,7 @@ UNLOCK TABLES;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
 mariadb-dump: Got error: 1146: "Table 'test.???????????????????????' doesn't exist" when using LOCK TABLES
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -4278,7 +4281,7 @@ CREATE TABLE t1(a int, b int);
 INSERT INTO t1 VALUES (1,1);
 INSERT INTO t1 VALUES (2,3);
 INSERT INTO t1 VALUES (3,4), (4,5);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -4553,7 +4556,7 @@ insert into t1 values (1232131);
 insert into t1 values (4711);
 insert into t1 values (3231);
 insert into t1 values (0815);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -4686,7 +4689,7 @@ CREATE DATABASE test;
 create database `test-database`;
 use `test-database`;
 create table test (a int);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 DROP TABLE IF EXISTS `test`;
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
@@ -4909,7 +4912,7 @@ CREATE TRIGGER `trig` BEFORE INSERT ON `test` FOR EACH ROW BEGIN
 END |
 ALTER DATABASE `test-database` CHARACTER SET latin1 COLLATE latin1_swedish_ci;
 ALTER DATABASE `test-database` CHARACTER SET utf8 COLLATE utf8_unicode_ci ;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `test` (
@@ -5393,7 +5396,7 @@ USE test;
 # Also verify that a prefix of the mode's name is enough.
 #
 CREATE TABLE t1 (a INT);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
 /*!40103 SET TIME_ZONE='+00:00' */;
 /*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
@@ -5626,7 +5629,7 @@ CREATE DATABASE `a\"'``b`;
 USE `a\"'``b`;
 CREATE PROCEDURE p1() BEGIN END;
 ALTER DATABASE `a\"'``b` COLLATE utf8_general_ci;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
 /*!50003 SET sql_mode              = '' */ ;
 ALTER DATABASE `a\"'``b` CHARACTER SET latin1 COLLATE latin1_swedish_ci ;
@@ -5675,7 +5678,7 @@ CREATE VIEW nonunique_table_view_name AS SELECT 1;
 
 ##################################################
 # --compact --databases db1 db2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `db1` /*!40100 DEFAULT CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci */;
 
@@ -5744,7 +5747,7 @@ USE `db2`;
 ##################################################
 # --compact db2
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `nonunique_table_name` (
@@ -5767,7 +5770,7 @@ INSERT INTO `nonunique_table_view_name` VALUES
 
 ##################################################
 # --compact --delayed-insert --no-data-med=0 --databases db2 db1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `db2` /*!40100 DEFAULT CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci */;
 
@@ -5899,7 +5902,7 @@ CREATE TABLE t1 (a int, b int);
 CREATE TRIGGER tt1_t1 BEFORE INSERT ON t1 FOR EACH ROW 
 SET NEW.b=NEW.a + 10;
 INSERT INTO t1 (a) VALUES (1),(2),(3);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -5948,7 +5951,7 @@ DROP TABLE t1;
 #
 # Without --replace and --insert-ignore
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -6044,7 +6047,7 @@ CREATE TABLE IF NOT EXISTS `transaction_registry` (
 #
 # With --replace
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -6150,7 +6153,7 @@ CREATE TABLE IF NOT EXISTS `transaction_registry` (
 #
 # With --insert-ignore
 #
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -6275,7 +6278,7 @@ insert into t3 values(2);
 insert into t3(`invisible`,  `a  b c & $!@#$%^&*( )`, `ds=~!@ \# $% ^ & * ( ) _ - = +` ) values(1,2,3);
 CREATE TABLE t4(√ã√è√å√è√é√ã√Å1 INT);
 insert into t4 values(1);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -6316,7 +6319,7 @@ CREATE TABLE `t4` (
 INSERT INTO `t4` VALUES
 (1);
 #Check side effect on --complete insert
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -6686,7 +6689,7 @@ DROP DATABASE test1;
 # MDEV-33727 mariadb-dump trusts the server and does not validate the data
 #
 create table t1 (a int);
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 DROP TABLE IF EXISTS `t1`;
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
diff --git a/mysql-test/main/openssl_1.result b/mysql-test/main/openssl_1.result
index 18294d16..48f2a082 100644
--- a/mysql-test/main/openssl_1.result
+++ b/mysql-test/main/openssl_1.result
@@ -77,7 +77,7 @@ DROP TABLE thread_status;
 SET GLOBAL event_scheduler=0;
 CREATE TABLE t1(a int);
 INSERT INTO t1 VALUES (1), (2);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -114,7 +114,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
@@ -151,7 +151,7 @@ UNLOCK TABLES;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
 /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/main/plugin_auth.result b/mysql-test/main/plugin_auth.result
index f8128355..44e49018 100644
--- a/mysql-test/main/plugin_auth.result
+++ b/mysql-test/main/plugin_auth.result
@@ -338,7 +338,7 @@ FLUSH PRIVILEGES;
 # Executing 'mysqladmin'
 mysqld is alive
 # Executing 'mysqldump'
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 # Executing 'mysql_upgrade'
 #
 # Bug #59657: Move the client authentication_pam plugin into the 
diff --git a/mysql-test/main/rpl_mysqldump_slave.result b/mysql-test/main/rpl_mysqldump_slave.result
index 6c28862b..edf811b0 100644
--- a/mysql-test/main/rpl_mysqldump_slave.result
+++ b/mysql-test/main/rpl_mysqldump_slave.result
@@ -7,15 +7,15 @@ connection slave;
 connection master;
 use test;
 connection slave;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- SET GLOBAL gtid_slave_pos='';
 CHANGE MASTER '' TO MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 STOP ALL SLAVES;
 -- SET GLOBAL gtid_slave_pos='';
 CHANGE MASTER '' TO MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
 START ALL SLAVES;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 STOP ALL SLAVES;
 -- SET GLOBAL gtid_slave_pos='';
 CHANGE MASTER '' TO MASTER_HOST='127.0.0.1', MASTER_PORT=MASTER_MYPORT, MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
@@ -23,7 +23,7 @@ START ALL SLAVES;
 start slave;
 Warnings:
 Note	1254	Slave is already running
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- SET GLOBAL gtid_slave_pos='';
 CHANGE MASTER '' TO MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
 start slave;
@@ -41,14 +41,14 @@ DROP TABLE t2;
 
 1. --dump-slave=1
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 SET GLOBAL gtid_slave_pos='0-1-1001';
 CHANGE MASTER '' TO MASTER_USE_GTID=slave_pos;
 -- CHANGE MASTER '' TO MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
 
 2. --dump-slave=2
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- SET GLOBAL gtid_slave_pos='0-1-1001';
 -- CHANGE MASTER '' TO MASTER_USE_GTID=slave_pos;
 -- CHANGE MASTER '' TO MASTER_LOG_FILE='master-bin.000001', MASTER_LOG_POS=BINLOG_START;
@@ -56,21 +56,21 @@ CHANGE MASTER '' TO MASTER_USE_GTID=slave_pos;
 
 1. --master-data=1
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- CHANGE MASTER TO MASTER_LOG_FILE='slave-bin.000001', MASTER_LOG_POS=BINLOG_START;
 CHANGE MASTER TO MASTER_USE_GTID=slave_pos;
 SET GLOBAL gtid_slave_pos='0-2-1003';
 
 2. --master-data=2
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- CHANGE MASTER TO MASTER_LOG_FILE='slave-bin.000001', MASTER_LOG_POS=BINLOG_START;
 -- CHANGE MASTER TO MASTER_USE_GTID=slave_pos;
 -- SET GLOBAL gtid_slave_pos='0-2-1003';
 
 3. --master-data --single-transaction
 
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 -- CHANGE MASTER TO MASTER_LOG_FILE='slave-bin.000001', MASTER_LOG_POS=BINLOG_START;
 CHANGE MASTER TO MASTER_USE_GTID=slave_pos;
 SET GLOBAL gtid_slave_pos='0-2-1003';
diff --git a/mysql-test/main/trigger_wl3253.result b/mysql-test/main/trigger_wl3253.result
index 6d77ed5e..a6e3881a 100644
--- a/mysql-test/main/trigger_wl3253.result
+++ b/mysql-test/main/trigger_wl3253.result
@@ -310,7 +310,7 @@ CREATE TABLE t1 (a INT);
 CREATE TRIGGER tr1_bi BEFORE INSERT ON t1 FOR EACH ROW SET @a:=1;
 CREATE TRIGGER tr2_bi BEFORE INSERT ON t1 FOR EACH ROW SET @a:=2;
 CREATE TRIGGER tr1_bu BEFORE UPDATE ON t1 FOR EACH ROW SET @a:=3;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -373,7 +373,7 @@ CREATE TRIGGER tr2_bi BEFORE INSERT ON t1 FOR EACH ROW SET @a:=2;
 CREATE TRIGGER tr0_bi BEFORE INSERT ON t1 FOR EACH ROW PRECEDES tr1_bi SET @a:=0;
 CREATE TRIGGER tr1_1_bi BEFORE INSERT ON t1 FOR EACH ROW FOLLOWS tr1_bi SET @a:=0;
 # Expected order of triggers in the dump is: tr0_bi, tr1_bi, tr1_1_bi, tr2_i.
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
diff --git a/mysql-test/suite/archive/archive_bitfield.result b/mysql-test/suite/archive/archive_bitfield.result
index 5cda525e..a42f4c68 100644
--- a/mysql-test/suite/archive/archive_bitfield.result
+++ b/mysql-test/suite/archive/archive_bitfield.result
@@ -180,7 +180,7 @@ INSERT INTO `t1` VALUES
 (NULL,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b'100000',b'010010',b'011111',4,5,5,5,5,5,5,5,5,5,3,2,1),
 (NULL,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b'000000',b'001100',b'111111',4,5,5,5,5,5,5,5,5,5,3,2,1),
 (NULL,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b'111111',b'000000',b'000000',4,5,5,5,5,5,5,5,5,5,3,2,1);
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 INSERT INTO `t1` VALUES (1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0x01,0x3F,0x3E,4,5,5,5,5,5,5,5,5,5,3,2,1);
 INSERT INTO `t1` VALUES (2,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0x02,0x00,0x3D,4,5,5,5,5,5,5,5,5,5,3,2,1);
 INSERT INTO `t1` VALUES (3,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0x04,0x0F,0x3B,4,5,5,5,5,5,5,5,5,5,3,2,1);
diff --git a/mysql-test/suite/compat/oracle/r/sp-package-mysqldump.result b/mysql-test/suite/compat/oracle/r/sp-package-mysqldump.result
index 8084bd44..d5e0c942 100644
--- a/mysql-test/suite/compat/oracle/r/sp-package-mysqldump.result
+++ b/mysql-test/suite/compat/oracle/r/sp-package-mysqldump.result
@@ -34,7 +34,7 @@ PROCEDURE p1;
 FUNCTION f1 RETURN INT;
 END;
 $$
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
diff --git a/mysql-test/suite/federated/federatedx.result b/mysql-test/suite/federated/federatedx.result
index 333b3ca8..f5f480b5 100644
--- a/mysql-test/suite/federated/federatedx.result
+++ b/mysql-test/suite/federated/federatedx.result
@@ -2243,7 +2243,7 @@ connection master;
 CREATE TABLE t1(id VARCHAR(20) NOT NULL, PRIMARY KEY(id)) ENGINE=FEDERATED 
 CONNECTION='mysql://root@127.0.0.1:SLAVE_PORT/test/t1';
 # Dump table t1 using mysqldump tool
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
diff --git a/mysql-test/suite/roles/definer.result b/mysql-test/suite/roles/definer.result
index a321ad9a..32607533 100644
--- a/mysql-test/suite/roles/definer.result
+++ b/mysql-test/suite/roles/definer.result
@@ -274,7 +274,7 @@ a	b	c
 111	4	0
 2	20	200
 delete from t1 where a=111;
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 
 CREATE DATABASE /*!32312 IF NOT EXISTS*/ `test` /*!40100 DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci */;
 
diff --git a/mysql-test/suite/s3/mysqldump.result b/mysql-test/suite/s3/mysqldump.result
index e0c0caf6..3d7b3b37 100644
--- a/mysql-test/suite/s3/mysqldump.result
+++ b/mysql-test/suite/s3/mysqldump.result
@@ -4,7 +4,7 @@ alter table t1 engine=S3;
 #####
 # mysqldump with --copy-s3-tables=0 (by default)
 ###
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 #####
 # mysqldump with --copy-s3-tables=0 (by default) XML
 ###
@@ -16,7 +16,7 @@ alter table t1 engine=S3;
 #####
 # mysqldump with --copy-s3-tables=1
 ###
-/*!999999\- enable the sandbox mode */ 
+/*M!999999\- enable the sandbox mode */ 
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
diff --git a/mysql-test/suite/sql_sequence/mysqldump.result b/mysql-test/suite/sql_sequence/mysqldump.result
index c2f8dea9..2568c8ef 100644
--- a/mysql-test/suite/sql_sequence/mysqldump.result
+++ b/mysql-test/suite/sql_sequence/mysqldump.result
@@ -3,7 +3,7 @@ CREATE TABLE t1(a INT, KEY (a)) KEY_BLOCK_SIZE=1024;
 insert into t1 values (1),(2);
 CREATE SEQUENCE x1 engine=innodb;
 # dump whole database
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 CREATE SEQUENCE `a1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=Aria;
 SELECT SETVAL(`a1`, 1, 0);
 CREATE SEQUENCE `x1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=InnoDB;
@@ -19,7 +19,7 @@ INSERT INTO `t1` VALUES
 (1),
 (2);
 # dump by tables order 1
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 CREATE SEQUENCE `a1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=Aria;
 SELECT SETVAL(`a1`, 1, 0);
 CREATE SEQUENCE `x1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=InnoDB;
@@ -35,7 +35,7 @@ INSERT INTO `t1` VALUES
 (1),
 (2);
 # dump by tables order 2
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 CREATE SEQUENCE `a1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=Aria;
 SELECT SETVAL(`a1`, 1, 0);
 CREATE SEQUENCE `x1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=InnoDB;
@@ -51,7 +51,7 @@ INSERT INTO `t1` VALUES
 (1),
 (2);
 # dump by tables only tables
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t1` (
@@ -63,7 +63,7 @@ INSERT INTO `t1` VALUES
 (1),
 (2);
 # dump by tables only sequences
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 CREATE SEQUENCE `a1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=Aria;
 SELECT SETVAL(`a1`, 1, 0);
 CREATE SEQUENCE `x1` start with 1 minvalue 1 maxvalue 9223372036854775806 increment by 1 cache 1000 nocycle ENGINE=InnoDB;
diff --git a/storage/connect/mysql-test/connect/r/mysql.result b/storage/connect/mysql-test/connect/r/mysql.result
index e91d17f7..379fc8ec 100644
--- a/storage/connect/mysql-test/connect/r/mysql.result
+++ b/storage/connect/mysql-test/connect/r/mysql.result
@@ -229,7 +229,7 @@ a
 20
 30
 # Start of mysqldump ------
-/*!999999\- enable the sandbox mode */
+/*M!999999\- enable the sandbox mode */
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `t2` (
-- 
2.40.0

