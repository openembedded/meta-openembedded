From 53d9b7ad6287313709a665baa79fc581dcdaf92a Mon Sep 17 00:00:00 2001
From: Jan Vermaete <jan.vermaete@gmail.com>
Date: Wed, 12 Nov 2025 19:58:20 +0100
Subject: [PATCH 1/1] ptest: disable failing tests

Tests did not run in qemux86-64

Upstream-Status: Pending [https://github.com/Kludex/uvicorn/discussions/2759]

Signed-off-by: Jan Vermaete <jan.vermaete@gmail.com>
---
 tests/protocols/test_websocket.py      | 3 +++
 tests/supervisors/test_multiprocess.py | 2 ++
 tests/test_config.py                   | 5 +++--
 3 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/tests/protocols/test_websocket.py b/tests/protocols/test_websocket.py
index 2e1a33a..ae1e041 100644
--- a/tests/protocols/test_websocket.py
+++ b/tests/protocols/test_websocket.py
@@ -685,6 +685,9 @@ MAX_WS_BYTES = 1024 * 1024 * 16
 MAX_WS_BYTES_PLUS1 = MAX_WS_BYTES + 1
 
 
+# FAIL: tests/protocols/test_websocket.py:test_send_binary_data_to_server_bigger_than_default_on_websockets[httptools-max=defaults sent=defaults+1]
+# FAIL: tests/protocols/test_websocket.py:test_send_binary_data_to_server_bigger_than_default_on_websockets[h11-max=defaults sent=defaults+1]
+@pytest.mark.skip(reason="failing on Yocto/OpenEmbedded")
 @pytest.mark.parametrize(
     "client_size_sent, server_size_max, expected_result",
     [
diff --git a/tests/supervisors/test_multiprocess.py b/tests/supervisors/test_multiprocess.py
index e1f594e..43002c3 100644
--- a/tests/supervisors/test_multiprocess.py
+++ b/tests/supervisors/test_multiprocess.py
@@ -75,6 +75,7 @@ def test_multiprocess_run() -> None:
     supervisor.join_all()
 
 
+@pytest.mark.skip(reason="fails on OpenEmbedded/Yocto")
 @new_console_in_windows
 def test_multiprocess_health_check() -> None:
     """
@@ -121,6 +122,7 @@ def test_multiprocess_sigbreak() -> None:  # pragma: py-not-win32
     supervisor.join_all()
 
 
+@pytest.mark.skip(reason="failing on Yocto/OpenEmbedded")
 @pytest.mark.skipif(not hasattr(signal, "SIGHUP"), reason="platform unsupports SIGHUP")
 def test_multiprocess_sighup() -> None:
     """
diff --git a/tests/test_config.py b/tests/test_config.py
index 9c80ca4..fe4c2e8 100644
--- a/tests/test_config.py
+++ b/tests/test_config.py
@@ -303,8 +303,9 @@ def test_asgi_version(app: ASGIApplication, expected_interface: Literal["2.0", "
 @pytest.mark.parametrize(
     "use_colors, expected",
     [
-        pytest.param(None, None, id="use_colors_not_provided"),
-        pytest.param("invalid", None, id="use_colors_invalid_value"),
+        #pytest.param(None, None, id="use_colors_not_provided"),  reason="failing on Yocto/OpenEmbedded"
+        #pytest.param("invalid", None, id="use_colors_invalid_value"),  reason="failing on Yocto/OpenEmbedded"
+
         pytest.param(True, True, id="use_colors_enabled"),
         pytest.param(False, False, id="use_colors_disabled"),
     ],
-- 
2.47.3

