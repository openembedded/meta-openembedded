From 28377c0e0fdd8669fb250e69745caf1c27ba541b Mon Sep 17 00:00:00 2001
From: Delta Regeer <bertjw@regeer.org>
Date: Sun, 3 Mar 2024 16:23:33 -0700
Subject: [PATCH] Remove test for getpeername()

CVE: CVE-2024-49769
Upstream-Status: Backport [https://github.com/Pylons/waitress/commit/86c680df4e4bdd40c78dec771cddcee059e802c4]
Signed-off-by: Gyorgy Sarvari <skandigraun@gmail.com>
---
 tests/test_wasyncore.py | 11 -----------
 1 file changed, 11 deletions(-)

diff --git a/tests/test_wasyncore.py b/tests/test_wasyncore.py
index e833c7e..5f38bd9 100644
--- a/tests/test_wasyncore.py
+++ b/tests/test_wasyncore.py
@@ -1451,17 +1451,6 @@ class Test_dispatcher(unittest.TestCase):
 
         return dispatcher(sock=sock, map=map)
 
-    def test_unexpected_getpeername_exc(self):
-        sock = dummysocket()
-
-        def getpeername():
-            raise OSError(errno.EBADF)
-
-        map = {}
-        sock.getpeername = getpeername
-        self.assertRaises(socket.error, self._makeOne, sock=sock, map=map)
-        self.assertEqual(map, {})
-
     def test___repr__accepting(self):
         sock = dummysocket()
         map = {}
